(function(){var e,t,n,r,a,i={}.hasOwnProperty,o=function(e,t){function n(){this.constructor=e}for(var r in t)i.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r=(a=window.California.Panel).Orders||(a.Orders={}),r.setup_table_helpers=function(){return DOM.Helpers.Factory.define("edit_order_btn",function(){var e;return e=DOM.Helpers.Factory.build("link_btn"),e.appendChild(DOM.Helpers.icon("icon-pencil")),e.title="Edit order",e})},California.Panel.define_readonly_cell("orders_actions",function(e){var t;return this.cell.innerHTML="","edit"===e?(t=this.cell.parentNode.idd,DOM.Helpers.btn_group(this.cell,function(e){var n;return n=DOM.Helpers.Factory.build("edit_order_btn"),n.href=Routes.edit_panel_order({id:t}),e.appendChild(n)})):void 0}),California.Panel.define_readonly_cell("orders_changed_by_manager",function(e){return this.cell.innerHTML="",e?this.cell.appendChild(DOM.Helpers.icon("fa fa-save text-warning")):void 0}),California.Panel.define_readonly_cell("orders_type",function(e){var t;return this.cell.innerHTML="",e?(t=this.cell.appendChild(DOM.Helpers.icon("fa text-info")),t.classList.add("special"===e?"fa-file-o":"fa-file-text-o"),this.cell.appendChild(t)):void 0}),California.Panel.define_readonly_cell("orders_mark",function(e){var t,n,r,a,i,o;if(this.cell.innerHTML="",e&&(r=function(){switch(e){case"uses_schedule":return"fa-calendar text-success";case"date_changed":return"fa-calendar text-danger";case"included_quantity":return"fa-truck text-success"}}())){for(t=this.cell.appendChild(DOM.Helpers.icon("fa")),o=r.split(" "),a=0,i=o.length;i>a;a++)n=o[a],t.classList.add(n);return this.cell.appendChild(t)}}),r.Table=n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.init_sorting=function(){return t.__super__.init_sorting.apply(this,arguments),this.sorting.setInitialSort(5,"asc")},t.prototype.get_selected_rows=function(){return this.instance.getCheckedRows(0).split(",")},t.prototype.delete_selected_rows=function(){return Progress.toggle(!0),this.save_data({selection:this.selection.change.serialize()})},t}(California.Panel.DHTMLXGridTable),r.Controller=t=function(){function e(){$("#by_creation_date").datepicker({format:"yyyy-mm-dd",autoclose:!0}),this.render_table("#orders-table")}return e.prototype.render_table=function(e){var t,a;return r.setup_table_helpers(),this.table=a=new n(e,{selection:["change"]}),Progress.toggle(!0),this.table.paginator.onBeforeNavigateToPage=function(){return Progress.toggle(!0)},t=$("#bulk-delete-btn").on("click.rails",function(e){return function(t){t.namespace&&e.table.delete_selected_rows()}}(this)).on("mousedown",function(e){return function(t){var n,r;n=$(t.target),r=e.table.selection.change.selectedRowsCount(),n.attr("data-confirm",n.data("message").replace(":count:",r))}}(this)),this.table.instance.attachEvent("onCheckbox",function(e){return function(n,r,a){var i;0===r&&(i=a||e.table.instance.getCheckedRows(0).length>0,t.prop("disabled",!i))}}(this)),this.table.instance.attachEvent("onAfterLoad",function(e){return function(){var n;return n=e.table.instance.getCheckedRows(0).length>0,t.prop("disabled",!n),Progress.toggle(!1)}}(this)),this.table.data_processor.attachEvent("onAfterUpdateFinish",function(e){return function(){return t.prop("disabled",!0),e.table.connector.setPage(1),e.table.load_data()}}(this))},e}(),r.ConfirmationRecreateOrderModal=e=function(){function e(e){var t;t=this,this.$modal=$(e)}return e.prototype.init=function(){var e,t,n;return n=(new Date).setHours(0,0,0,0),e=new Date(Date.parse($("#creation_date").val())).setHours(0,0,0,0),t=n>e,$("#creation_date").val()||(t=!0),this.$modal.modal({show:t})},e}(),$(function(){return FilterSearchButtons.apply($(".orders-filter")),$(".page-panel-orders-edit")&&(r.confirm_recreate_order_modal=new e("#confirmation-recreate-order"),r.confirm_recreate_order_modal.init()),$(".page-orders").length?r.controller=new t:void 0})}).call(this);